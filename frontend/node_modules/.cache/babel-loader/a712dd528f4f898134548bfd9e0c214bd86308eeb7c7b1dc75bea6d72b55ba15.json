{"ast":null,"code":"import React,{useState,useEffect}from'react';import ScheduleForm from'./components/ScheduleForm';import Login from'./components/Login';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[loggedIn,setLoggedIn]=useState(()=>{return localStorage.getItem('token')!==null;});const[schedules,setSchedules]=useState([]);const[activeTab,setActiveTab]=useState('listar');const fetchSchedules=async()=>{try{const token=localStorage.getItem('token');const res=await axios.get('http://localhost:3001/api/schedules',{headers:{Authorization:`Bearer ${token}`}});setSchedules(res.data);}catch(err){var _err$response,_err$response2;if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401||((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===403){alert('Sessão expirada. Faça login novamente.');localStorage.removeItem('token');setLoggedIn(false);}else{console.error('Erro ao buscar agendamentos:',err);}}};const handleLogin=async(username,password)=>{try{const res=await axios.post('http://localhost:3001/api/login',{username,password});localStorage.setItem('token',res.data.token);setLoggedIn(true);fetchSchedules();}catch(err){alert('Usuário ou senha incorretos');}};const handleLogout=()=>{localStorage.removeItem('token');setLoggedIn(false);};const handleDelete=async id=>{try{const token=localStorage.getItem('token');await axios.delete(`http://localhost:3001/api/schedules/${id}`,{headers:{Authorization:`Bearer ${token}`}});fetchSchedules();}catch(err){var _err$response3,_err$response4;if(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===401||((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.status)===403){alert('Sessão expirada. Faça login novamente.');localStorage.removeItem('token');setLoggedIn(false);}else{console.error('Erro ao excluir:',err);}}};useEffect(()=>{if(loggedIn){fetchSchedules();}},[loggedIn]);if(!loggedIn){return/*#__PURE__*/_jsx(Login,{onLogin:handleLogin});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"TI Alerts - Google Chat\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,style:{float:'right'},children:\"Sair\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"tabs\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('criar'),className:activeTab==='criar'?'active':'',children:\"Novo Agendamento\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('listar'),className:activeTab==='listar'?'active':'',children:\"Agendamentos Criados\"})]}),activeTab==='criar'&&/*#__PURE__*/_jsx(ScheduleForm,{onSuccess:fetchSchedules}),activeTab==='listar'&&/*#__PURE__*/_jsxs(\"div\",{className:\"agendamentos\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Agendamentos Ativos\"}),/*#__PURE__*/_jsx(\"ul\",{children:schedules.map(s=>/*#__PURE__*/_jsxs(\"li\",{className:\"item-agendamento\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:s.texto}),\" - \",s.tipo_periodicidade,\" \\xE0s \",s.hora_execucao]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(s.id),children:\"Excluir\"})]},s.id))})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","ScheduleForm","Login","axios","jsx","_jsx","jsxs","_jsxs","App","loggedIn","setLoggedIn","localStorage","getItem","schedules","setSchedules","activeTab","setActiveTab","fetchSchedules","token","res","get","headers","Authorization","data","err","_err$response","_err$response2","response","status","alert","removeItem","console","error","handleLogin","username","password","post","setItem","handleLogout","handleDelete","id","delete","_err$response3","_err$response4","onLogin","className","children","onClick","style","float","onSuccess","map","s","texto","tipo_periodicidade","hora_execucao"],"sources":["D:/Projetos/Ti_alerts/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport ScheduleForm from './components/ScheduleForm';\r\nimport Login from './components/Login';\r\nimport axios from 'axios';\r\n\r\nfunction App() {\r\n  const [loggedIn, setLoggedIn] = useState(() => {\r\n    return localStorage.getItem('token') !== null;\r\n  });\r\n  const [schedules, setSchedules] = useState([]);\r\n  const [activeTab, setActiveTab] = useState('listar');\r\n\r\n  const fetchSchedules = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const res = await axios.get('http://localhost:3001/api/schedules', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      setSchedules(res.data);\r\n    } catch (err) {\r\n      if (err.response?.status === 401 || err.response?.status === 403) {\r\n        alert('Sessão expirada. Faça login novamente.');\r\n        localStorage.removeItem('token');\r\n        setLoggedIn(false);\r\n      } else {\r\n        console.error('Erro ao buscar agendamentos:', err);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleLogin = async (username, password) => {\r\n    try {\r\n      const res = await axios.post('http://localhost:3001/api/login', {\r\n        username,\r\n        password\r\n      });\r\n      localStorage.setItem('token', res.data.token);\r\n      setLoggedIn(true);\r\n      fetchSchedules();\r\n    } catch (err) {\r\n      alert('Usuário ou senha incorretos');\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    setLoggedIn(false);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      await axios.delete(`http://localhost:3001/api/schedules/${id}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      fetchSchedules();\r\n    } catch (err) {\r\n      if (err.response?.status === 401 || err.response?.status === 403) {\r\n        alert('Sessão expirada. Faça login novamente.');\r\n        localStorage.removeItem('token');\r\n        setLoggedIn(false);\r\n      } else {\r\n        console.error('Erro ao excluir:', err);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (loggedIn) {\r\n      fetchSchedules();\r\n    }\r\n  }, [loggedIn]);\r\n\r\n  if (!loggedIn) {\r\n    return <Login onLogin={handleLogin} />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h1>TI Alerts - Google Chat</h1>\r\n      <button onClick={handleLogout} style={{ float: 'right' }}>Sair</button>\r\n\r\n      <div className=\"tabs\">\r\n        <button onClick={() => setActiveTab('criar')} className={activeTab === 'criar' ? 'active' : ''}>\r\n          Novo Agendamento\r\n        </button>\r\n        <button onClick={() => setActiveTab('listar')} className={activeTab === 'listar' ? 'active' : ''}>\r\n          Agendamentos Criados\r\n        </button>\r\n      </div>\r\n\r\n      {activeTab === 'criar' && <ScheduleForm onSuccess={fetchSchedules} />}\r\n\r\n      {activeTab === 'listar' && (\r\n        <div className=\"agendamentos\">\r\n          <h2>Agendamentos Ativos</h2>\r\n          <ul>\r\n            {schedules.map(s => (\r\n              <li key={s.id} className=\"item-agendamento\">\r\n                <div>\r\n                  <strong>{s.texto}</strong> - {s.tipo_periodicidade} às {s.hora_execucao}\r\n                </div>\r\n                <button onClick={() => handleDelete(s.id)}>Excluir</button>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}